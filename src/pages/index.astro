---
import HeroSection from "../components/hero-section.astro";
import AboutSection from "../components/about-section.astro";
import ExperienceSection from "../components/experience-section.astro";
import Footer from "../components/footer.astro";
import ProjectsSection from "../components/project-section.astro";
import TimeTravelSection from "../components/time-travel-section.astro";
import WritingSection from "../components/writing-section.astro";
import { hero } from "../data/portfolio";
import Layout from "../layouts/layout.astro";
---

<Layout title={`${hero.name} â€“ ${hero.role}`} description={hero.tagline}>
	<main class="min-h-screen bg-transparent">
		<HeroSection />
		
		<div class="mx-auto max-w-6xl space-y-16 px-6 py-16 sm:px-8 lg:py-24">
			<AboutSection />
			<ExperienceSection />
			<ProjectsSection />
			<WritingSection />
			<TimeTravelSection />
			<Footer />
		</div>
	</main>

	<script>
		import gsap from "gsap";
		import { ScrollTrigger } from "gsap/ScrollTrigger";

		type LenisWindow = Window & {
			lenis?: {
				on?: (event: string, callback: () => void) => void;
			};
		};

		const prefersReducedMotion = window.matchMedia("(prefers-reduced-motion: reduce)").matches;

		if (!prefersReducedMotion) {
			gsap.registerPlugin(ScrollTrigger);

			const lenisWindow = window as LenisWindow;
			const lenis = lenisWindow.lenis;
			if (lenis?.on) {
				lenis.on("scroll", ScrollTrigger.update);
			}

			const sections = document.querySelectorAll("[data-animate='section']");
			sections.forEach((section) => {
				gsap.fromTo(
					section,
					{ opacity: 0, y: 48 },
					{
						opacity: 1,
						y: 0,
						duration: 1,
						ease: "power3.out",
						scrollTrigger: {
							trigger: section,
							start: "top 80%",
							toggleActions: "play none none reverse",
						},
					},
				);
			});

			const cards = document.querySelectorAll("[data-animate='card']");
			if (cards.length) {
				gsap.fromTo(
					cards,
					{ opacity: 0, y: 32 },
					{
						opacity: 1,
						y: 0,
						stagger: 0.15,
						duration: 0.9,
						ease: "power2.out",
						scrollTrigger: {
							trigger: "#projects",
							start: "top 75%",
						},
					},
				);
			}

			const timelineItems = document.querySelectorAll("[data-animate='timeline-item']");
			timelineItems.forEach((item) => {
				gsap.fromTo(
					item,
					{ borderColor: "transparent" },
					{
						borderColor: "rgba(255, 255, 255, 0.3)",
						duration: 0.8,
						ease: "power1.out",
						scrollTrigger: {
							trigger: item,
							start: "top 85%",
						},
					},
				);
			});
		}
	</script>
</Layout>
